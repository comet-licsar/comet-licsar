<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LiCSAR proc &mdash; COMET LiCSAR  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LiCSAR Framebatch" href="../licsar_framebatch/index.html" />
    <link rel="prev" title="LiCSAR Wiki" href="../wiki.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> COMET LiCSAR
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../wiki.html">LiCSAR Wiki</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Main LiCSAR Tools</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">LiCSAR proc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#forming-licsar-interferograms-sentinel-1">Forming LiCSAR interferograms (Sentinel-1)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-slc-files">1. create SLC files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#coregister-to-rslc-files">2. coregister to RSLC files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-interferograms">3. create interferograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unwrap-interferograms">4. unwrap interferograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#geocoding-results">5. geocoding results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#post-processing">Post-processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reunwrapping-existing-interferograms">Reunwrapping existing interferograms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#licsar-to-licsbas-jasmin">LiCSAR to LiCSBAS (JASMIN)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decomposition-to-e-u-n-vectors">Decomposition to E-U(+N) vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bringing-enu-model-values-to-line-of-sight">Bringing ENU model values to line-of-sight</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#tools-operating-with-licsar-data">Tools operating with LiCSAR data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#licsar-data-quality-checker">LiCSAR Data Quality Checker</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../licsar_framebatch/index.html">LiCSAR Framebatch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licsbas/index.html">LiCSBAS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../daz/index.html">daz</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="apidoc.html">LiCSAR proc</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Further information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ciw.html">COMET InSAR Workshop Materials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer comments and advices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html">Notes about documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html#admin-or-dev-comments">Admin or dev comments</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">COMET LiCSAR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>LiCSAR proc</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/licsar_proc/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="licsar-proc">
<h1>LiCSAR proc<a class="headerlink" href="#licsar-proc" title="Permalink to this heading"></a></h1>
<p>This section describes core functionality of LiCSAR system, that is used by LiCSAR FrameBatch system but can be used independently.
Some parameters of particular use (often not fully integrated in FrameBatch) are discussed here, yet we assume that you work with
standard project started by licsar_make_frame.sh.</p>
<section id="forming-licsar-interferograms-sentinel-1">
<h2>Forming LiCSAR interferograms (Sentinel-1)<a class="headerlink" href="#forming-licsar-interferograms-sentinel-1" title="Permalink to this heading"></a></h2>
<p>The core processing scripts are also described (in more details, and still valid, although of older date) in <a class="reference external" href="https://gitlab.com/comet_licsar/licsar_documentation/-/wikis/ciw2019/licsar">https://gitlab.com/comet_licsar/licsar_documentation/-/wikis/ciw2019/licsar</a></p>
<section id="create-slc-files">
<h3>1. create SLC files<a class="headerlink" href="#create-slc-files" title="Permalink to this heading"></a></h3>
<p>see</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LiCSAR_01_mk_images</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>normal use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>frameid= # e.g. 016A_02562_091313
m= # reference date, e.g. 20191103
s= # e.g. 20220101
e= # e.g. 20220201
LiCSAR_01_mk_images.py -n -d . -f $frameid -m $m -s $s -e $e -a 4 -r 20
</pre></div>
</div>
<p>This command would create SLC for given frame in given time period. For this to work, you should be sure the data are existing on disk and are
ingested to LiCSInfo database (command arch2DB.py). This is done automatically through licsar_make_frame.sh.</p>
</section>
<section id="coregister-to-rslc-files">
<h3>2. coregister to RSLC files<a class="headerlink" href="#coregister-to-rslc-files" title="Permalink to this heading"></a></h3>
<p>see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LiCSAR_02_coreg</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>normal use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>frameid= # e.g. 016A_02562_091313
m= # reference date, e.g. 20191103
LiCSAR_02_coreg.py -f $frameid -d . -m $m -i
</pre></div>
</div>
<p>This command would coregister/resample all files in SLC folder to RSLC directory, for given frame.
The standard constrains apply, for example limit for spectral diversity estimation to combine epochs with up to Btemp=180 days.</p>
<p>In order to force-skip the 180 days limit, use parameter ‘-E’ (some extra tweaks there, EIDP-related, including skip of Btemp check).
In practice, to connect a cluster of epochs far in time, choose one SLC in that cluster that has no missing bursts (see e.g. their mli preview, or check size),
and add its date to slclist.txt and try coregister that one by <code class="docutils literal notranslate"><span class="pre">LiCSAR_02_coreg.py</span> <span class="pre">-f</span> <span class="pre">$frameid</span> <span class="pre">-d</span> <span class="pre">.</span> <span class="pre">-m</span> <span class="pre">$m</span> <span class="pre">-i</span> <span class="pre">-l</span> <span class="pre">slclist.txt</span> <span class="pre">-E</span></code>.</p>
<p>Only then start the standard procedure (without -E) for all the SLCs left. This way you would make sure that the other epochs would use appropriate
RSLC3 for the spectral diversity (see e.g. <a class="reference external" href="https://www.mdpi.com/2072-4292/12/15/2430">https://www.mdpi.com/2072-4292/12/15/2430</a> )</p>
</section>
<section id="create-interferograms">
<h3>3. create interferograms<a class="headerlink" href="#create-interferograms" title="Permalink to this heading"></a></h3>
<p>see:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LiCSAR_03_mk_ifgs</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>The script is very useful if you have your own list of interferograms to form, e.g. in a text file containing lines as ‘20200101_20200202’ etc. (see help).
An extra parameter -n would use parallel processing on given number of CPUs.</p>
</section>
<section id="unwrap-interferograms">
<h3>4. unwrap interferograms<a class="headerlink" href="#unwrap-interferograms" title="Permalink to this heading"></a></h3>
<p>For the original unwrapping approach, running on radar-coordinate interferograms, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">LiCSAR_04_unwrap</span><span class="o">.</span><span class="n">py</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
<p>and then you may geocode the result, as discussed in next section.</p>
<p>However, you may find useful (and faster) the updated version, currently used by LiCSAR FrameBatch, that performs unwrapping on already geocoded wrapped interferograms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unwrap_geo</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>Finally, you may experiment with the updated (much improved) unwrapper, running through python, and starting again from geocoded interferograms. This script is used by licsar2licbas.sh described later.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">unwrp_multiscale</span> <span class="k">as</span> <span class="nn">unw</span>
<span class="n">help</span><span class="p">(</span><span class="n">unw</span><span class="o">.</span><span class="n">process_frame</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="geocoding-results">
<h3>5. geocoding results<a class="headerlink" href="#geocoding-results" title="Permalink to this heading"></a></h3>
<p>For geocoding results, please use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">create_geoctiffs_to_pub</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</section>
</section>
<section id="post-processing">
<h2>Post-processing<a class="headerlink" href="#post-processing" title="Permalink to this heading"></a></h2>
<section id="reunwrapping-existing-interferograms">
<h3>Reunwrapping existing interferograms<a class="headerlink" href="#reunwrapping-existing-interferograms" title="Permalink to this heading"></a></h3>
<p>Standard LiCSAR products use general parameters for unwrapping. Here we document the python tool <code class="docutils literal notranslate"><span class="pre">lics_unwrap.py</span></code>.
We will soon augment it to allow processing directly from command line, for now you may check the <a class="reference internal" href="apidoc.html#apidoc-unwrap"><span class="std std-ref">API documentation</span></a>.</p>
</section>
<section id="licsar-to-licsbas-jasmin">
<h3>LiCSAR to LiCSBAS (JASMIN)<a class="headerlink" href="#licsar-to-licsbas-jasmin" title="Permalink to this heading"></a></h3>
<p>This script runs LiCSBAS processing from the LiCSAR data. To be used in JASMIN environment.</p>
<p>The script would read frame data from $LiCSAR_public directory, prepare them for LiCSBAS and run LiCSBAS with default parameters.
If you run the script from directory with your GEOC outputs, it would instead use the local data from this folder.
Afterwards, you may just fine tune parameters of LiCSBAS step 15 (and 16) and rerun them, for the final result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">licsar2licsbas</span><span class="o">.</span><span class="n">sh</span> <span class="n">frame</span> <span class="p">[</span><span class="n">startdate</span><span class="p">]</span> <span class="p">[</span><span class="n">enddate</span><span class="p">]</span>
<span class="c1">#e.g. 155D_02611_050400 20141001 20200205</span>
<span class="c1">#parameters:</span>
<span class="c1">#-M 10 .... this will do extra multilooking (in this example, 10x multilooking)</span>
<span class="c1">#-u ....... use the (extra Gaussian-improved multilooking and) reunwrapping procedure (useful if multilooking..)</span>
<span class="c1">#-c ....... if the reunwrapping is to be performed, use cascade (might be better, especially when with shores)</span>
<span class="c1">#-s ....... if the reunwrapping is to be performed, use smoothing (two-pass unw approach, similar effect as with cascade, only milder)</span>
<span class="c1">#-H ....... this will use hgt to support unwrapping (only if using reunwrapping)</span>
<span class="c1">#-T ....... use testing version of LiCSBAS</span>
<span class="c1">#-t 0.5 ... change coherence threshold to 0.5 (default: 0.3) during reunwrapping (-u)</span>
<span class="c1">#-S ....... strict mode - e.g. in case of GACOS, use it only if available for ALL ifgs</span>
<span class="c1">#-G lon1/lon2/lat1/lat2  .... clip to this AOI</span>
<span class="c1">##</span>
<span class="c1">## following is an ongoing work, for testing only:</span>
<span class="c1">##-C ....... use coherence stability index instead of orig coh per ifg (experimental - might help against loop closure errors, maybe)</span>
<span class="c1">##-k ....... use cohratio everywhere (i.e. for unwrapping, rather than orig coh - this is experimental attempt)</span>
</pre></div>
</div>
<p>While parameters -C, -k are only related to a short-term experiment (should conclude in use of amplitude stability and/or general coherence for masking and weighting),
the other parameters are practically used/recommended to understand.</p>
<p>Explaining on example, use of</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">licsar2licsbas</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="o">-</span><span class="n">M</span> <span class="mi">5</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">T</span> <span class="o">-</span><span class="n">G</span> <span class="mf">5.1</span><span class="o">/</span><span class="mf">5.2</span><span class="o">/</span><span class="mf">3.3</span><span class="o">/</span><span class="mf">3.5</span> <span class="mi">100</span><span class="n">D_00000_010101</span> <span class="mi">20150101</span> <span class="mi">20160101</span>
</pre></div>
</div>
<p>would grab <strong>wrapped</strong> interferograms of this (fictive) frame 100D that cover period of year 2015, then it will check for availability of GACOS corrections and use them if they exist for most of epochs
(if you used -S, GACOS corrections would be applied only if they exist for ALL epochs). Then it would crop them to the coordinates given by -G, and then it will <strong>reunwrap</strong> them (-u) with 5x multilooking
(so the resolution if using default LiCSAR data would become approx. 500 m), with support of cascade approach (-c) that means a longer wave signal is first estimated/unwrapped (using 10x the -M factor)
and used to bind the final unwrapped result - therefore especially decorrelated areas would not induce unwrapping error.. hopefully.</p>
<p>The data here will be prepared to folder GEOCml5GACOSclip.
Then, the -T would use up-to-date LiCSBAS codes with their experimental functionality ON (in this case, e.g. nullification of pixels in unwrapped pairs with loop closure errors over pi is ON).
The whole procedure will run in the background through JASMIN’s LOTUS server (see generated .sh files) and once finished, results will be in TS_GEOCml5GACOSclip, plus additional files will be generated
(e.g. geotiffs of velocity estimate, or standard NetCDF file that can be loaded to e.g. QGIS or ncview to plot time series from ‘cum’ layer, etc.)</p>
</section>
<section id="decomposition-to-e-u-n-vectors">
<h3>Decomposition to E-U(+N) vectors<a class="headerlink" href="#decomposition-to-e-u-n-vectors" title="Permalink to this heading"></a></h3>
<p>This section should contain information on both decomposition from A+D - for now, you may go through <a class="reference external" href="https://github.com/andwatson/interseismic_practical">tutorial by Andrew Watson</a>.</p>
</section>
<section id="bringing-enu-model-values-to-line-of-sight">
<h3>Bringing ENU model values to line-of-sight<a class="headerlink" href="#bringing-enu-model-values-to-line-of-sight" title="Permalink to this heading"></a></h3>
<p>This section should contain inverse procedure (with example) using LiCSAR E,N,U tif files to convert ENU-&gt;LOS.</p>
</section>
</section>
<section id="tools-operating-with-licsar-data">
<h2>Tools operating with LiCSAR data<a class="headerlink" href="#tools-operating-with-licsar-data" title="Permalink to this heading"></a></h2>
<section id="licsar-data-quality-checker">
<h3>LiCSAR Data Quality Checker<a class="headerlink" href="#licsar-data-quality-checker" title="Permalink to this heading"></a></h3>
<p>This tool is a GUI (fast-)programmed to fast-look into preview PNGs of LiCSAR interferograms, and fast-flag errors in them. Once the operator (you) flags erroneous data within selected LiCSAR frame, the software will auto-generates a small .savedResults file.
If you inform us about bad interferograms in LiCSAR system by sending the file to our team, you directly help improve our open dataset, as we will remove and reprocessed the corrupt data.
Additionally, if you are a student of University of Leeds, and you will run (after setting the environment as <a class="reference external" href="https://gitlab.com/comet_licsar/licsar_documentation/-/wikis/licsar_settings_leeds">described here</a>) <code class="docutils literal notranslate"><span class="pre">lics_checker.py</span></code> at some Leeds server,
all your flagged data and the output .savedResults file will be stored in folder <code class="docutils literal notranslate"><span class="pre">/nfs/a1/insar/lics_check</span></code>, and thus we will be able to apply machine learning, once we prepare a long-wished workflow to auto-detect such errors.</p>
<p>The use of the tool is simple:</p>
<ol class="arabic simple">
<li><p>Run <code class="docutils literal notranslate"><span class="pre">lics_checker.py</span></code> (you may also <a class="reference external" href="../../licsar_proc/python/lics_checker.py">download it from here</a>, just make sure you install required python libraries if you run it from non-leeds-uni computer).</p></li>
<li><p>The tool will download list of LiCSAR frames. Select track and frame you want to look into. If this frame was already <em>checked</em>, it will not appear in the list, until you untick <code class="docutils literal notranslate"><span class="pre">exclude</span> <span class="pre">checked</span></code>.</p></li>
<li><p>Once you click OK, the tool will download existing png previews of wrapped and unwrapped interferograms - the output is shown in the terminal (together with info on output directory). Note, we actually notice some connection issues causing download to stuck - if this happens, just press CTRL+C, the program will continue downloading other pairs.</p></li>
<li><p>Once downloaded, you will see main screen of the viewer:</p></li>
</ol>
<a class="reference internal image-reference" href="../_images/lics_checker.png"><img alt="Main window of lics_checker" src="../_images/lics_checker.png" style="width: 600px;" /></a>
<p>Here, you can flag type of error that you see - either by clicking on its radio button by mouse (by default: set to no error), or pressing key corresponding to the error’s number on your keyboard.
To switch to the next image, either click on the ‘Next image’ button, or just press <code class="docutils literal notranslate"><span class="pre">Right</span> <span class="pre">arrow</span></code>. Especially using arrows, you can fast-scroll through the interferograms.
You can also use buttons <code class="docutils literal notranslate"><span class="pre">PgDwn</span></code>, <code class="docutils literal notranslate"><span class="pre">PgUp</span></code> to scroll by 10 interferograms, or <code class="docutils literal notranslate"><span class="pre">shift-PgDwn</span></code>, <code class="docutils literal notranslate"><span class="pre">shift-PgUp</span></code> to scroll by 100.
After the last interferogram, the program will notify you that it saved the results to a file (see terminal). Also, the results are auto-saved during the process, so your next check will use existing flags.
To add, clicking on the preview you will see it in larger resolution.</p>
<p>And that’s all folks, happy flagging!</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../wiki.html" class="btn btn-neutral float-left" title="LiCSAR Wiki" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../licsar_framebatch/index.html" class="btn btn-neutral float-right" title="LiCSAR Framebatch" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, COMET and CEMAC teams.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>